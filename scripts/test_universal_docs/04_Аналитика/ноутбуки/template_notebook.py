# Ð¨Ð°Ð±Ð»Ð¾Ð½ Ð´Ð»Ñ Jupyter Notebook
# Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ ÐºÐ°Ðº .ipynb Ñ„Ð°Ð¹Ð»

# =============================================================================
# ÐÐ½Ð°Ð»Ð¸Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ…: [ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°]
# ÐÐ²Ñ‚Ð¾Ñ€: [Ð¤Ð˜Ðž]
# Ð”Ð°Ñ‚Ð°: [YYYY-MM-DD]
# Ð¦ÐµÐ»ÑŒ: [ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°]
# =============================================================================

# %% [markdown]
# # ÐÐ½Ð°Ð»Ð¸Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ…: [ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ]
# 
# ## Ð¦ÐµÐ»ÑŒ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ
# [ÐžÐ¿Ð¸ÑÐ°Ñ‚ÑŒ Ñ†ÐµÐ»ÑŒ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°]
# 
# ## Ð“Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ñ‹
# 1. [Ð“Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ð° 1]
# 2. [Ð“Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ð° 2]
# 
# ## Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
# - [Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº 1]: Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ
# - [Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº 2]: Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ

# %% Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ñ‹ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
plt.style.use('seaborn-v0_8')
plt.rcParams['figure.figsize'] = (12, 8)
plt.rcParams['font.size'] = 12
sns.set_palette("husl")

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ pandas
pd.set_option('display.max_columns', None)
pd.set_option('display.max_rows', 100)

print("âœ… Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹")

# %% [markdown]
# ## 1. Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸ Ð¿ÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð´Ð°Ð½Ð½Ñ‹Ñ…

# %% Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…
# Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° Ð²Ð°ÑˆÐ¸ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
data = pd.read_csv('data/sample_data.csv')

print(f"Ð Ð°Ð·Ð¼ÐµÑ€ Ð´Ð°Ð½Ð½Ñ‹Ñ…: {data.shape}")
print(f"ÐŸÐµÑ€Ð¸Ð¾Ð´ Ð´Ð°Ð½Ð½Ñ‹Ñ…: {data['date'].min()} - {data['date'].max()}")

# %% ÐŸÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·
print("Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ñ…:")
data.info()

print("\nÐ¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸:")
data.describe()

print("\nÐŸÑ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ:")
missing = data.isnull().sum()
print(missing[missing > 0])

# %% [markdown]
# ## 2. Ð˜ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ… (EDA)

# %% Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ñ‡Ð¸ÑÐ»Ð¾Ð²Ñ‹Ñ… Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…
numeric_cols = data.select_dtypes(include=[np.number]).columns
n_cols = len(numeric_cols)
n_rows = (n_cols + 2) // 3

fig, axes = plt.subplots(n_rows, 3, figsize=(15, 5*n_rows))
axes = axes.flatten() if n_rows > 1 else [axes]

for i, col in enumerate(numeric_cols):
    if i < len(axes):
        data[col].hist(bins=30, ax=axes[i])
        axes[i].set_title(f'Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ {col}')
        axes[i].set_xlabel(col)
        axes[i].set_ylabel('Ð§Ð°ÑÑ‚Ð¾Ñ‚Ð°')

# Ð¡ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð»Ð¸ÑˆÐ½Ð¸Ðµ subplot'Ñ‹
for i in range(len(numeric_cols), len(axes)):
    axes[i].set_visible(False)

plt.tight_layout()
plt.show()

# %% ÐšÐ¾Ñ€Ñ€ÐµÐ»ÑÑ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ð°
plt.figure(figsize=(10, 8))
correlation_matrix = data[numeric_cols].corr()
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0)
plt.title('ÐšÐ¾Ñ€Ñ€ÐµÐ»ÑÑ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ð°')
plt.show()

# %% [markdown]
# ## 3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð³Ð¸Ð¿Ð¾Ñ‚ÐµÐ·

# %% Ð“Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ð° 1
# [ÐšÐ¾Ð´ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ð³Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ñ‹]
print("Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð³Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ñ‹ 1:")
# Ð’Ð°Ñˆ ÐºÐ¾Ð´ Ð·Ð´ÐµÑÑŒ

# %% Ð“Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ð° 2
# [ÐšÐ¾Ð´ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð³Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ñ‹]
print("Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð³Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ñ‹ 2:")
# Ð’Ð°Ñˆ ÐºÐ¾Ð´ Ð·Ð´ÐµÑÑŒ

# %% [markdown]
# ## 4. Ð’Ñ‹Ð²Ð¾Ð´Ñ‹ Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸

# %% ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¸Ð½ÑÐ°Ð¹Ñ‚Ñ‹
insights = [
    "Ð˜Ð½ÑÐ°Ð¹Ñ‚ 1: [Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ]",
    "Ð˜Ð½ÑÐ°Ð¹Ñ‚ 2: [Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ]", 
    "Ð˜Ð½ÑÐ°Ð¹Ñ‚ 3: [Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ]"
]

print("ðŸ” ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð²Ñ‹Ð²Ð¾Ð´Ñ‹:")
for i, insight in enumerate(insights, 1):
    print(f"{i}. {insight}")

# %% Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸
recommendations = [
    "Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ 1: [Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ]",
    "Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ 2: [Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ]",
    "Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ 3: [Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ]"
]

print("\nðŸ’¡ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸:")
for i, rec in enumerate(recommendations, 1):
    print(f"{i}. {rec}")

# %% [markdown]
# ## 5. Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð³Ð¸
# 
# - [ ] Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ [Ñ‚ÐµÐ¼Ð°]
# - [ ] ÐŸÑ€Ð¾Ð²ÐµÑÑ‚Ð¸ A/B Ñ‚ÐµÑÑ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ [Ð³Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ð°]
# - [ ] Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ [Ñ†ÐµÐ»ÐµÐ²Ð°Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ]
# - [ ] ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð°Ð½Ð°Ð»Ð¸Ð· Ð² Ð²Ð¸Ð´Ðµ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°
